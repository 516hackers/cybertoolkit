#!/bin/bash
# Nikto Wrapper - 516 Hackers Toolkit

set -e

LOG_DIR="../../logs"
mkdir -p "$LOG_DIR"
LOG_FILE="$LOG_DIR/nikto_$(date +%Y%m%d_%H%M%S).log"

echo "[516] Nikto Wrapper - Starting web vulnerability scan" | tee -a "$LOG_FILE"

if ! command -v nikto &> /dev/null; then
    echo "Error: nikto not found. Install with:" | tee -a "$LOG_FILE"
    echo "  Kali: sudo apt install nikto" | tee -a "$LOG_FILE"
    exit 1
fi

if [ $# -eq 0 ]; then
    echo "Usage: $0 <target_url>" | tee -a "$LOG_FILE"
    echo "Example: $0 http://example.com" | tee -a "$LOG_FILE"
    exit 1
fi

TARGET=$1

echo "[516] Scanning: $TARGET" | tee -a "$LOG_FILE"

nikto -h "$TARGET" -o "$LOG_FILE" -Format txt

echo "[516] Nikto scan completed. Results saved to: $LOG_FILE" | tee -a "$LOG_FILE"
